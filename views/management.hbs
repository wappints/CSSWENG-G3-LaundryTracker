{{>header}}

   <script type="text/javascript" src="../../node_modules/jquery/dist/jquery.min.js" ></script>
   <body>      
             <div hidden id="ULTIMATEhiddendate" value="{{DDate}}"></div>  
       <div hidden id="ULTIMATEhiddenacc" value="{{ACCType}}"></div>  
                   <!-- Start of Add Employee Modal -->
          <div class="modal fade" id="addEmployeeModal" tabindex="-1" role="dialog" aria-labelledby="addEmployeeModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Add Employee</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body col-12">
                  <h5>Employee Name</h5>
                  <input id="inputEmployeeName" class="text" value="">
                </div>
 
                <div class="modal-body">
                 <h5>Password</h5>
                 <input id="inputEmployeePass" type="password" value="">
                 <br>
                 <input class="form-check-input mt-1" type="checkbox" onclick="showEmpPass()" value="" id="flexCheckDefault">
                 <label class="form-check-label" for="flexCheckDefault">
                   Show Password
                 </label>
               </div>
 
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                  <a type="button" id="addConfirmEmployee" class="btn btn-success confirm">Confirm</a>
                </div>
                <script>
                function showEmpPass() {
                  var x = document.getElementById("inputEmployeePass");
                  if (x.type === "password") {
                      x.type = "text";
                      } else {
                      x.type = "password";
                  }
                  }
                      $("#addConfirmEmployee").click((event) => {
                        var Name = event.currentTarget.parentElement.parentElement.children[1].children[1].value
                        var Pass =  event.currentTarget.parentElement.parentElement.children[2].children[1].value
                        console.log(Name)
                        console.log(Pass)
                        $.post("/addAccount", {Name : Name, Pass : Pass}, function(result){})
                        document.location.reload()
                      })
                  </script>
              </div>
            </div>
          </div>
          <!-- End of Add Employee Modal -->
          <!-- Start of Delete Account Modal -->
         <div class="modal fade" id="DeleteAccountModal" tabindex="-1" role="dialog" aria-labelledby="DeleteAccountLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Delete Account</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                Are you sure you want to delete this account permanently?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" id="deleteAccConfirm" class="btn btn-danger">Confirm</button>
              </div>
            </div>
          </div>
        </div>
        <!-- End of Delete Account Modal -->
          <!-- Start of Edit Admin Modal -->
          <div class="modal fade" id="editAdminModal" tabindex="-1" role="dialog" aria-labelledby="editAdminModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Edit Admin</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body col-12">
                  <h5>Employee Name</h5>
                  <input id="adminNameInput" class="text" value="">
                </div>
 
                <div class="modal-body">
                 <h5>Password</h5>
                 <input id="adminPassInput" type="password" value="">
                 <br>
                <input class="form-check-input mt-1" type="checkbox" onclick="showEditAdminPass()" value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  Show Password
                </label>
               </div>
 
 
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                  <button type="button" class="btn btn-success" id="adminConfirmBtn" data-dismiss="modal">Confirm</button>
                <script>
                 function showAdminPass() {
                 var x = document.getElementById("adminPass");
                if (x.type === "password") {
                x.type = "text";
                } else {
                x.type = "password";
                }
                }
                 function showEditAdminPass() {
                 var x = document.getElementById("adminPassInput");
                           if (x.type === "password") {
                                  x.type = "text";
                              } else {
                            x.type = "password";
                         }
                           }
                  $("#adminConfirmBtn").click((event) => {
                    var name = $("#adminNameInput").val()
                    var pass = $("#adminPassInput").val()
                    var ACCType = $("#ULTIMATEhiddenacc").text()
                    var DDate = $("#ULTIMATEhiddendate").text()
                    var adminID = $("#adminID").text()
                    console.log(name)
                    console.log(pass)

                  $.post("/management/" + ACCType + "/" + DDate, {EMPName : name, EMPPass : pass, ID : adminID}, function(result){

                  })
                  document.location.reload()
                  })
              </script>
                </div>
              </div>
            </div>
          </div>
          <!-- End of Edit Admin Modal -->
      </div>
   </div>
   </nav>
         
         <!-- Cart -->
      <div class="container-fluid">

        <row>
          <div class="col-6 mt-3">
              <h4> Admin </h4>
          </div>
        </row>
        {{#each admin}}
        <div class="col-3 mt-3">
          <table class="table table-light">
            <tbody class="border">
              <div id="adminID" hidden>{{this.AccID}}</div>
              <th scope="col">Admin Name:
                <input id="adminName"class="mb-2" type="text" value="{{this.EMPName}}" readonly>
                <br>
                Password:
                <input  id="adminPass" type="password" value="{{this.EMPPass}}" readonly> <br>
                <input class="form-check-input" type="checkbox" onclick="showAdminPass()"value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  Show Password
                </label> </th>
                 <br>
                <th scope="col"> <a id="editAdminbtn" class="btn btn-outline-primary" ><i   class="bi bi-pencil-square" href="editAdminModal" data-toggle="modal" data-target="#editAdminModal"></i> </th>
            </tbody>
          </table>
          </div>
      {{/each}}
          <br><br>
          <row>
            <div class="col-6 mt-3">
                <h4> <a class="btn btn-primary"><i class="bi bi-plus-lg" href="addEmployeeModal" data-toggle="modal" data-target="#addEmployeeModal"></i></a> Employee List</h4>
            </div>
          </row>
          <div class="col-3 mt-3">
          <table class="table table-light">
             {{#each accounts}}
          <!-- Start of Edit Employee Modal -->
          <div class="modal fade" id="editEmployeeModal" tabindex="-1" role="dialog" aria-labelledby="editEmployeeModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Edit Employee</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body col-12">
                  <h5>Employee Name</h5> 
                  <input class="employeeNameInput" type="text" value=""></div>
                <div class="modal-body">
                 <h5>Password</h5>
                 <input class="employeePassInput" type="password" value="">
                 <br>
                 <input class= "form-check-input mt-1" type="checkbox" value="" id="flexCheckDefault2">
                 <label class="form-check-label" for="flexCheckDefault2">Show Password</label>
               </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                  <button type="button" class="btn btn-success confirm now">Confirm</button>
                </div>
              </div>
            </div>
          </div>
          <!-- End of Edit Employee Modal -->
            <tbody>
              <th scope="col">Employee Name:
                <input class="mb-2" type="text" value="{{this.EMPName}}" readonly>
                <br>
                Password: 
                <input type="password" value="{{this.EMPPass}}" readonly> <br>
                <input id="flexCheckDefault1" class="form-check-input" type="checkbox" value="">
                <label class="form-check-label" for="flexCheckDefault1">
                  Show Password
                </label></th>
                <th scope="col"> <a class="btn btn-outline-primary confirm"> <input value="{{this.AccID}}" hidden> <i class="bi bi-pencil-square" href="editEmployeeModal" data-toggle="modal" data-target="#editEmployeeModal"></i></a>
                 <input value="{{this.AccID}}" hidden></input>
                <br> <a class="btn btn-outline-danger mt-2"> <i class="bi bi-trash" href="DeleteAccountModal" data-toggle="modal" data-target="#DeleteAccountModal"></i></a>
            </tbody>
            {{/each}}
          </table>
          </div>
                
               <script>
              $('.form-check-input').change(function() {
                console.log("JIHRO")
                var entry = event.currentTarget.parentElement.children[2]
                console.log(entry)
  
                if($(this).is(":checked"))
                  entry.setAttribute("type", "text")
                else
                  entry.setAttribute("type", "password")
              console.log(entry)  
              })
              $('.form-check-input.mt-1').change(function() {
                console.log("JIHRO2")
                var entry = event.currentTarget.parentElement.children[1]
                console.log(entry)
  
                if($(this).is(":checked"))
                  entry.setAttribute("type", "text")
                else
                  entry.setAttribute("type", "password")
              console.log(entry)  
              })
              $('.btn.btn-outline-danger.mt-2').click(function(event) {
                var entry = event.currentTarget.parentElement.children[1].value     
                console.log(entry)
                $("#deleteAccConfirm").click(function()
                {
                  $.post("/delAccount", {ID : entry},  function(result){
                     event.currentTarget.parentElement.parentElement.remove() 
                     window.location.reload()
                  })
                })
              })
               $('.btn.btn-outline-primary.confirm').click(function(event) {
                var entry = event.currentTarget.parentElement.children[1].value
                console.log(entry)
                $(".btn.btn-success.confirm.now").click(function(event)
                {
                  console.log("I AM HERE")
                  var Name = event.currentTarget.parentElement.parentElement.children[1].children[1].value
                  var Pass = event.currentTarget.parentElement.parentElement.children[2].children[1].value
                  var DDate = $("#ULTIMATEhiddendate").value
                  var ACCType = $("#ULTIMATEhiddenacc").value
                  console.log(Name)
                  console.log(Pass)
                  $.post("/management" + "/" + ACCType + "/" + DDate, {ID : entry, Name : Name, Pass : Pass},  function(result){
                     window.location.reload()
                  })
                })

              })
            </script>

   </body>
